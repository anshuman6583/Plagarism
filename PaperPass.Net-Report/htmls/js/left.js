(function(T,P){P(function(){var o=typeof isHasDetailReport;var r;if(o=="boolean"&&isHasDetailReport==true){var e=typeof isWordDetailReport;if(e=="boolean"&&isWordDetailReport==true){var t=T.operateState.getDetailNum(Report.report_id);var i=T.operateState.getDetailOffset(Report.report_id);var a=T.operateState.getDetailSize(Report.report_id);var s=T.operateState.getZoomBtnState(Report.report_id);var n=T.operateState.getLineState(Report.report_id);r=true}else{var t=T.operateState.getPlainTextDetailNum(Report.report_id);var i=T.operateState.getPlainTextDetailOffset(Report.report_id);var a=T.operateState.getPlainTextDetailSize(Report.report_id);var s=T.operateState.getPlainTextZoomBtnState(Report.report_id);var n=T.operateState.getPlainTextLineState(Report.report_id);r=false}}else{var e=typeof isWordOriginalReport;if(e=="boolean"&&isWordOriginalReport==true){var l=T.operateState.getOriginalNum(Report.report_id);var p=T.operateState.getOriginalOffset(Report.report_id);var c=T.operateState.getOriginalSize(Report.report_id);var u=T.operateState.getOriZoomBtnState(Report.report_id);r=true}else{var l=T.operateState.getPlainTextOriginalNum(Report.report_id);var p=T.operateState.getPlainTextOriginalOffset(Report.report_id);var c=T.operateState.getPlainTextOriginalSize(Report.report_id);var u=T.operateState.getPlainTextOriZoomBtnState(Report.report_id);r=false}}var d=T.operateState.getLanguage(Report.report_id);if(d!=""){d=typeof multilingual[d]=="undefined"?"English":d}else{d=typeof multilingual[user_language]=="undefined"?"English":user_language}g(d);function g(t){P("*[data-lang]").each(function(){var e=P(this).data().lang;P(this).html(multilingual[t][e])})}parent.postMessage("get_language","*");parent.parent.postMessage("get_language","*");var f=`<span class="pageNum">1</span><span class="partition">/</span><span class="totalPage"></span>`;P(".top_Num").html(f);var h=P(".upkmzjakmc").length;P(".totalPage").text(h);P(".top_Num").show();if(o=="boolean"&&isHasDetailReport==true){k(a?a:1);AddH(a?a:1);m(t,i);size=a?a:1;_(s,isWordDetailReport)}else{k(c?c:1);AddH(c?c:1);m(l,p);size=c?c:1;_(u,isWordOriginalReport)}function m(e,t){if(e==""||e=="null"){P(".pageNum").text(1);P(".input_pageNum").val(1)}else{P(".pageNum").text(e);P(".input_pageNum").val(e);P("#toall_Num").attr("href","#"+e);P("body").scrollTop(t)}}function _(e,t){if(t){if(e==""||e=="block"){P(".allButton").hide();P(".CollagenButton").hide();P("#menuButton").css("background","#323639")}else{P(".allButton").show();P(".CollagenButton").show();P("#menuButton").css("background","#1b1e1f")}}else{if(e==""||e=="block"){P(".allButton").hide();P(".CollagenButton").hide();P("#menuButton").css("background","#f2f2f2")}else{P(".allButton").show();P(".CollagenButton").show();P("#menuButton").css("background","#f2f2f2")}}}var b=1;function v(){var a=P("body").scrollTop();var o=-15;P(".upkmzjakmc").each(function(e,t){var i=P(this)[0].getBoundingClientRect().height+15;if(o<a&&a<=o+i){b=e+1}o+=i});P(".pageNum").text(b);P(".input_pageNum").val(b);P("#toall_Num").attr("href","#"+b)}function k(e){_Size=Math.round(e*100)/100;B=Math.round(_Size*100);if(B==""){P(".percent_num").text(100)}else{P(".percent_num").text(B)}P(".upkmzjakmc").css("transform","scale("+_Size+")");if(_Size<1){P(".upkmzjakmc").css("transform-origin","left top")}else{P(".upkmzjakmc").css("transform-origin","center top")}if(b!=undefined){P(".jump_page").attr("href","#"+b)}P(".upkmzjakmc").each(function(e,t){var i=P(this)[0].getBoundingClientRect().width+30;var a=P(this)[0].getBoundingClientRect().height+15;P(this).parent(".jcjymywwzd").css("width",i);P(this).parent(".jcjymywwzd").css("height",a)});P("body").off("scroll").on("scroll",function(){v(_Size);var e=P("body").scrollTop();var t=b;var i={PageNum:t,page_nav_click:O};parent.parent.postMessage(i,"*");if(o=="boolean"&&isHasDetailReport==true){if(r){T.operateState.saveDetailNum(Report.report_id,t);T.operateState.saveDetailOffset(Report.report_id,e)}else{T.operateState.savePlainTextDetailNum(Report.report_id,t);T.operateState.savePlainTextDetailOffset(Report.report_id,e)}}else{if(r){T.operateState.saveOriginalNum(Report.report_id,t);T.operateState.saveOriginalOffset(Report.report_id,e)}else{T.operateState.savePlainTextOriginalNum(Report.report_id,t);T.operateState.savePlainTextOriginalOffset(Report.report_id,e)}}});var t=_Size;if(o=="boolean"&&isHasDetailReport==true){if(r){T.operateState.saveDetailSize(Report.report_id,t)}else{T.operateState.savePlainTextDetailSize(Report.report_id,t)}}else{if(r){T.operateState.saveOriginalSize(Report.report_id,t)}else{T.operateState.savePlainTextOriginalSize(Report.report_id,t)}}}P(".toall_div").mousemove(function(){if(r){P(this).css({"background-color":"#424649","border-radius":"2px"})}else{P(this).css({border:"1px solid #dbdbdb","background-color":"#fbfbfb"})}P(this).children(".tip").css("display","block")}).mouseout(function(){if(r){P(this).css("background-color","transparent")}else{P(this).css({"background-color":"transparent",border:"1px solid transparent"})}P(this).children(".tip").css("display","none")});P(".Switch").click(function(){P(".layui-layer-shade").show();P(".layui-layer-title").html(multilingual[d].SwitchMode);P(".detail_btn").data("type","switch");if(r){P(".layui-layer-content").html(multilingual[d].TextMode)}else{P(".layui-layer-content").html(multilingual[d].WordMode)}});P(".detail_btn").click(function(){type=P(this).data("type");if(type=="switch"){P(".layui-layer-btn0").attr("href",P(this).data("txtLink"));if(o=="boolean"&&isHasDetailReport==true){if(r){T.operateState.saveInitDetailReport(Report.report_id,"text");parent.postMessage("switch-detail-text","*");parent.parent.postMessage("switch-detail-text","*")}else{T.operateState.saveInitDetailReport(Report.report_id,"word");parent.postMessage("switch-detail-word","*");parent.parent.postMessage("switch-detail-word","*")}}else{if(r){parent.postMessage("switch-original-text","*")}else{parent.postMessage("switch-original-word","*")}}}if(type=="subline"){var e=P("span").hasClass("red");var t=P("span").hasClass("orange");if(e==false&&t==false){y("")}else{var i=P(".red").parent().eq(0).hasClass("red_a")||P(".orange").parent().eq(0).hasClass("orange_a");var a=String(i);y(a);if(r){T.operateState.saveLineState(Report.report_id,a)}else{T.operateState.savePlainTextLineState(Report.report_id,a)}}}});P(".layui-layer-close, .layui-layer-btn1, .layui-layer-btn0").click(function(){P(".layui-layer-shade").hide()});P(".subline").click(function(){P(".layui-layer-shade").show();P(".layui-layer-title").html(multilingual[d].AuxiliaryLine);P(".detail_btn").data("type","subline");if(P(".red").parent().eq(0).hasClass("red_a")||P(".orange").parent().eq(0).hasClass("orange_a")){P(".layui-layer-content").html(multilingual[d].CancelLine)}else{P(".layui-layer-content").html(multilingual[d].UseLine)}curHref=P(".detail_btn").attr("href");if(curHref!="#"){P(".detail_btn").data("txtLink",P(".detail_btn").attr("href"));P(".layui-layer-btn0").attr("href","#")}});function y(e){if(e==""||e=="true"){P(".red").parent().removeClass("red_a");P(".orange").parent().removeClass("orange_a");if(r){P(".subline").css("background-position","-106px -162px")}else{P(".subline").css("background-position","-161px -9px")}}else{P(".red").parent().addClass("red_a");P(".orange").parent().addClass("orange_a");if(r){P(".subline").css("background-position","-146px -159px")}else{P(".subline").css("background-position","-43px -153px")}}}y(n);P(".bottom").click(function(){P(".bottom_a").attr("href","#"+(b+1));P("#toall_Num").attr("href","#"+(b+1))});P(".top").click(function(){P(".top_a").attr("href","#"+(b-1));P("#toall_Num").attr("href","#"+(b-1))});P(".input_pageNum").focus(function(){if(r){P(".input_pageNum").css("background-color","#424649")}else{P(".input_pageNum").css("background-color","#fbfbfb")}P(".input_pageNum").select()}).blur(function(){P(".input_pageNum").css("background-color","transparent");page1=P(".input_pageNum").val();if(page1<=h&&/^[1-9]\d*$/.test(page1)){P("#toall_Num").attr("href","#"+page1)}else{P(".input_pageNum").val(b)}}).mousemove(function(){if(r){P(".input_pageNum").css("background-color","#424649")}else{P(".input_pageNum").css("background-color","#fbfbfb")}P(this).siblings(".tip").css("display","block")}).mouseout(function(){if(P(".input_pageNum").is(":focus")){if(r){P(".input_pageNum").css("background-color","#424649")}else{P(".input_pageNum").css("background-color","#fbfbfb");P(this).siblings(".tip").css("display","none")}}else{P(".input_pageNum").css("background-color","transparent");P(this).siblings(".tip").css("display","none")}}).keyup(function(){if(event.keyCode==13){page1=P(".input_pageNum").val();if(page1<=h&&/^[1-9]\d*$/.test(page1)){P("#toall_Num").attr("href","#"+page1);window.location.hash="#"+page1}else{P(".input_pageNum").val(b);P(".input_pageNum").blur()}}});var S=T.operateState.getFoldState(Report.report_id);z(S);function z(e){if(e==""||e=="block"){P(".btn_fold_left").css("display","none");P(".btn_fold_right").css("display","block")}else{P(".btn_fold_left").css("display","block");P(".btn_fold_right").css("display","none")}var t={FoldState:e};parent.postMessage(t,"*");parent.parent.postMessage(t,"*");T.operateState.saveFoldState(Report.report_id,e)}P(".btn_fold").click(function(){var e=P(".btn_fold_left").css("display");_size=T.operateState.getDetailSize(Report.report_id);z(e);AddH(_size)});var w=hasScrollbar();if(w){var x=getScrollbarWidth();P(".btn_fold").css("right",x+"px");P("body").css("border-right","0");P(".fixed_shadow").css("width","calc(100% - "+x+"px)")}else{P(".btn_fold").css("right",0+"px");P("body").css("border-right","1px solid #e8e8e8");P(".fixed_shadow").css("width","100%")}P("#originalButton").on("click",function(){P(".zoom-shade").show();size=1;_size=size;k(_size);AddH(_size);N()});P("#fitPageButton").click(function(){P(".zoom-shade").show();var e=P("body")[0].getBoundingClientRect().height;size=(e-20)/minHeight;_size=size;k(_size);AddH(_size);N()});P("#fitWidthButton").click(function(){P(".zoom-shade").show();var e=P("body")[0].getBoundingClientRect().width;size=(e-163)/minWidth;if(size>2){size=2}_size=size;k(_size);AddH(_size);N()});function R(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}var B;P("#zoomOutButton").click(function(){P(".zoom-shade").show();if(B%10==0&&size<=2){size+=.1}if(B%10>=5&&size<=2){size=R(B/100,1)}if(B%10<5&&size<=2){size=R(B/100,1)+.1}if(size>2){size=2}_size=size;k(_size);AddH(_size);N()});P("#zoomInButton").click(function(){P(".zoom-shade").show();if(B%10==0&&size>=.1){size-=.1}else if(B%10>=5&&size>=.1){size=R(B/100,1)-.1}else if(B%10<5&&size>=.1){size=R(B/100,1)}if(size<.1){size=.1}_size=size;k(_size);AddH(_size);N()});P(".allButton").mousemove(function(){if(r){P(this).css("background","#1b1e1f")}else{P(this).css("background-image","-webkit-linear-gradient( 90deg, rgb(216,216,216) 0%, rgb(239,239,239) 100%)")}P(this).children(".bot_tip").css("display","block")}).mouseout(function(){if(r){P(this).css("background","#323639")}else{P(this).css("background","#f2f2f2")}P(this).children(".bot_tip").css("display","none")});P("#menuButton").click(function(){var e=P(".allButton").css("display");P(".percent_list").hide();if(r){P("#CollagenButton").css("background","#323639")}else{P("#CollagenButton").css("background","#f2f2f2")}if(o=="boolean"&&isHasDetailReport==true){if(r){T.operateState.saveZoomBtnState(Report.report_id,e)}else{T.operateState.savePlainTextZoomBtnState(Report.report_id,e)}}else{if(r){T.operateState.saveOriZoomBtnState(Report.report_id,e)}else{T.operateState.savePlainTextOriZoomBtnState(Report.report_id,e)}}if(e=="block"){P(".allButton").hide();P(".CollagenButton").hide();if(r){P("#menuButton").css("background","#323639")}else{P("#menuButton").css("background","#f2f2f2")}}else{P(".allButton").show();P(".CollagenButton").show();if(r){P("#menuButton").css("background","#1b1e1f")}}}).mousemove(function(){if(r){P("#menuButton").css("background","#1b1e1f")}P(this).children(".menu_tip").css("display","block")}).mouseout(function(){P(this).children(".menu_tip").css("display","none");if(P(".allButton").css("display")=="block"){if(r){P("#menuButton").css("background","#1b1e1f")}}else{if(r){P("#menuButton").css("background","#323639")}else{P("#menuButton").css("background","#f2f2f2")}}});P("#CollagenButton").click(function(e){var t=P(".percent_list").css("display");if(t=="block"){P(".percent_list").hide();P(this).children(".percent_tip").css("display","block")}else{P(".percent_list").show();if(r){P("#CollagenButton").css("background","#1b1e1f")}else{P("#CollagenButton").css("background-image","-webkit-linear-gradient( 90deg, rgb(224,224,224) 0%, rgb(170,170,170) 170%)")}}P(this).children(".percent_tip").css("display","none");e.stopPropagation()}).mousemove(function(){if(r){P("#CollagenButton").css("background","#1b1e1f")}else{P("#CollagenButton").css("background-image","-webkit-linear-gradient( 90deg, rgb(224,224,224) 0%, rgb(170,170,170) 170%)")}if(P(".percent_list").css("display")=="block"){P(this).children(".percent_tip").css("display","none")}else{P(this).children(".percent_tip").css("display","block")}}).mouseout(function(){if(P(".percent_list").css("display")=="block"){if(r){P("#CollagenButton").css("background","#1b1e1f")}else{P("#CollagenButton").css("background-image","-webkit-linear-gradient( 90deg, rgb(224,224,224) 0%, rgb(170,170,170) 170%)")}}else{if(r){P("#CollagenButton").css("background","#323639")}else{P("#CollagenButton").css("background","#f2f2f2")}}P(this).children(".percent_tip").css("display","none")});P(document).click(function(){P(".percent_list").hide();if(r){P("#CollagenButton").css("background","#323639")}else{P("#CollagenButton").css("background","#f2f2f2")}});P(".zoom-shade").click(function(e){var t=P(".percent_list").css("display");if(t=="block"){P(".percent_list").show()}else{P(".percent_list").hide()}e.stopPropagation()});P(".percent_li").click(function(e){P(".zoom-shade").show();var t=P(this).children(".li_text").text();size=t/100;_size=size;k(_size);AddH(_size);N();e.stopPropagation()}).mousemove(function(){if(r){P(this).css("background","#1b1e1f")}else{P(this).css("background","#e9e9e9")}}).mouseout(function(){if(r){P(this).css("background","#323639")}else{P(this).css("background","#f2f2f2")}});function N(){setTimeout(function(){P(".zoom-shade").hide()},200)}function C(e){return JSON.stringify(JSON.parse(e)).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var H=JSON.parse(C(detail_title_info));if(o=="boolean"&&isHasDetailReport==true){P("#mbxsgxktna a[target='right']").mouseover(function(){var e=`<div class="similarTip"><div>${multilingual[d].Similarity}: <span class="num"></span>%</div></div>`;var t=`<div>${multilingual[d].SimilarityTip} !</div>`;P("#mbxsgxktna").append(e);var i=P(this).data().id;P(this).parent().css("z-index","");var a=T.operateState.getFoldState(Report.report_id);if(a=="none"){P(".similarTip").append(t)}P("div[class='similarTip'] .num").html(H[i].score)}).mouseout(function(){P("div[class='similarTip']").remove()}).mousemove(function(e){var t=e||window.event;var i=document.documentElement.clientWidth;var a=document.documentElement.clientHeight;var o=t.clientY+20;var r=t.clientX+20;if(i-t.clientX<120){r=t.clientX-100}if(a-t.clientY<70){o=t.clientY-50}P("div[class='similarTip']").css({left:r+"px",top:o+"px"})}).click(function(){var e=T.operateState.getFoldState(Report.report_id);if(e=="none"){return false}})}P(document).on("click",".edit_icon",function(){var e=P(this).prev().text();var t={section_edit:e};parent.parent.postMessage(t,"*")});P(document).on("click",".modify_document",function(){var e={modify_document:true};parent.parent.postMessage(e,"*")});var O="false";window.addEventListener("message",function(e){if(e.data.EnterId){window.location.hash="#"+e.data.EnterId}if(e.data.page_nav_click){O=e.data.page_nav_click}if(e.data.leng){d=e.data.leng;g(d);T.operateState.saveLanguage(Report.report_id,d)}});if(o=="boolean"&&isHasDetailReport==true){parent.parent.postMessage("Page_Loading","*")}else{parent.postMessage("Page_Loading","*")}})})(Report,jQuery);function hasScrollbar(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)}function getScrollbarWidth(){var e=document.createElement("div");e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;";document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;document.body.removeChild(e);return t}var arrW=new Array;var arrH=new Array;$(".upkmzjakmc").each(function(e,t){arrW.push($(this).width());arrH.push($(this).height())});function getMaxCountWidth(e){var t=new Array;for(var i in e){var a=e[i];var o=0;if(!t.hasOwnProperty(a)){t[a]=1}else{o=t[a];o=o+1;t[a]=o}}var r=0;var s=0;for(var n in t){var l=t[n];if(l>=r){r=l;if(s==0){s=n}else if(n>s){s=n}}}return s}function getMaxCountHeight(e){var t=new Array;for(var i in e){var a=e[i];var o=0;if(!t.hasOwnProperty(a)){t[a]=1}else{o=t[a];o=o+1;t[a]=o}}var r=0;var s=0;for(var n in t){var l=t[n];if(l>=r){r=l;if(s==0){s=n}else if(n<s){s=n}}}return s}var minWidth=getMaxCountWidth(arrW);var minHeight=getMaxCountHeight(arrH);var size=1;var _size;function AddH(e){var t=document.documentElement.clientWidth;var i=document.documentElement.clientHeight;var a=$(".upkmzjakmc:last")[0].getBoundingClientRect().height+30;var o=i-a;if(a>=i){$("#Add_height").css("height",0)}else{$("#Add_height").css("height",o)}var r=minWidth*e;var s=$(".top_Num").width()+25;var n=(t-r)/2;if(r<=500){n=n-s}else if(r>=t-105){n=77}else{n=n+15}$(".top_Num").css("right",n)}$(window).resize(function(){AddH(size);var e=hasScrollbar();if(e){var t=getScrollbarWidth();$(".btn_fold").css("right",t+"px");$("body").css("border-right","0")}else{$(".btn_fold").css("right",0+"px");$("body").css("border-right","1px solid #e8e8e8")}});