<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-gray">
    <div class="doc-ctx">
        <div class="alert alert-success" role="alert" data-lang="AlertSuccess">These contents which turn into green has been temprarily saved in your paper.</div>
        <div class="paper-txt">
            <p class="text-idt25" data-id="1">School of Electrical Sciences Internship:Software Validation Intern at Mentor Graphics An internship authored by Anshuman Upadhyay 180030003 Supervised by Prof.Sunil Dutt 17 December, 2021Abstract I worked as a software validation intern at Siemens EDA formerly known as Mentor Graphics.They have various projects which are called as campaigns.Each team member is assigned some of those ’campaigns’ which the assigned person has to work upon and passthe required number of test cases for the campaigned to be marked ’done’ or ’locked’.I worked upon two campaigns - ’suspend resume’ and ’netropy delay’ campaign.There were around 50 test cases for each of them.Contents 1 Introduction 3 1.1 Hardware build up of device .. . . . . . . . . . . . . . . . . . . . . . . . . .4 1.2 Working of the device .. . . . . . . . . . . . . . . . . . . . .. . . . . . . .4 1.3 Overview of the campaigns I worked up .. . . . . . . . . . . . . . . . . . .5 2 Suspend Resume Campaign 7 2.1 Introduction .. . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . .7 2.2 Suspend-Resume script .. . . . . . . . . . . . . . . . . . . . . . . . . . . . .8 2.3 Working of the script .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .8 2.4 Types of suspend-resume .. . . . . . . . . . . . . . . . . . . . . . . . . . .9 2.5 Arguments that could be provided to the script .. . . . . . . . . . . . . . .9 2.6 Conclusion .. . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .10 3 Netropy Delay Campaign 11 3.1 Introduction .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . .11 3.2 Netropy delay script .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .11 3.3 Working of the script .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .11 3.4 Types of delay modelling .. . . . . . . . . . . . . . . . . . . . . . . . . . .13 3.5 Arguments that could be provided to the script .. . . . . . . . . . . . . . .13 3.6 Conclusion .. . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .14 4 C-API testing 15 4.1 Introduction .. . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . .15 4.2 Working of the script .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . .15 14.3 Arguments that could be provided to the script .. . . . . . . . . . . . . . .16 4.4 Conclusion .. . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .16 5 JSON-Screen match 17 5.1 Introduction .. . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . .17 5.2 Working of the script .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . .18 5.3 Arguments that could be provided to the script .. . . . . . . . . . . . . . .18 5.4 Conclusion .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . .18 References 19 2Chapter 1 Introduction Mentor Graphics isa US based electronic design company which was acquired by Siemens in 2017 and now is knows as Siemens EDA.Electronic Design Automation (EDA)fields are segment consisting of software, hardware, and services with the collective goal of assisting in the definition,planning, design, implementation, verification, and subsequent manufacturing of semiconductor devices, or chips.</p><p class="text-idt25" data-id="2">I was in the Software Verification team which focused on the companies famous product called Veloce.</p><p class="text-idt25" data-id="3">Simulation of a chip or microprocessor designs take an enormous amount of time given the complexity of the designs.To make the process of verification of these designs faster Mentor Graphics designed a device named Veloce.</p><p class="text-idt25" data-id="4">Veloce is a hardware accelerated emulation device.Hardware acceleration refers to the process by which an application will offload certain computing tasks onto specialized hardware components within the system,enabling greater efficiency than is possible in software running on a general-purpose CPU alone.</p><p class="text-idt25" data-id="5">The Veloce hardware-assisted verification system is used for the rapid verification of highly sophisticated, next-generation integrated circuit (IC) designs.It is the first complete, integrated offering that combines best-in-class virtual platform, hardware emulation,and Field ProgrammableGate Array (FPGA) prototyping technologies and paves the way to leverage the latest powerful hardware-assisted verification methodologies.</p><p class="text-idt25" data-id="6">31.1 Hardware build up of device Hardware components of Veloce device:</p><p class="text-idt25" data-id="7">•LUT :small piece of RAM that is loaded whenever we power up the device•SBMEM :fast storage components having supporting incredibly fast read and write operations•Logic Gates :logic gates made up using CMOS and PMOS technologies•AVBs :allows you to create a single network for data like control information using an AVB-compatible switch.</p><p class="text-idt25" data-id="8">Figure 1.1:Veloce Device 1.2 Working of the device The device works with the help of software and applications written in multiple languages mostly C and bash.We run a test case or design using APIs.Mentor currently provides remote usage to customers.So the customers interact via servers.There are tens of servers or machines interacting with each other.The daemon tool controls automated resource allocation to the hardware and the softwares breaks up the design in multiple4logical chunks to get them mapped on LUTs and logical gates and finally merge output chunks obtained.</p><p class="text-idt25" data-id="9">Figure 1.2:Veloce Architecture 1.3 Overview of the campaigns I worked up I worked upon two campaigns for which I was the owner.Other than that I assisted my mentor in his two campaigns.</p><p class="text-idt25" data-id="10">•Suspend-Resume campaign :Using bash script suspend resume designs•Netropy delay :Since the whole emulation process involves a lot of servers, we do delay modelling using python•C-API testing :Testing a C API using a caller C script whioch again wrapped up using a wrapper bash script•JSON-screen match :Python script for automated verification of resource reservation results from two different sources 5Each of these campaigns hadover 50 test cases each on which the scripts were tested for errors and bugs.For the Suspend-Resume and Netropy delay campaigns I was supposed to pass as many test cases as possible,identify the shortcomings in my script and do necessary modification or changes accordingly.For the C-API and JSON-screen match campaigns I was assigned some bugs on (my mentor told meover call or text) and I changed my scipt as per the requirements and conditions told by him.</p><p class="text-idt25" data-id="11">6Chapter 2 Suspend Resume Campaign The first of my major campaigns that I worked upon was suspend-resume.Designs running on the Veloce device were suspended and resumed using linux shell commands and bash scripting.</p><p class="text-idt25" data-id="12">2.1 Introduction Hardware resources are critical and limited including both physical memory and storage.The designs that needed to be very are very large in size (some even over 50GBs).It is not possible to get memory as large as this and also very fast.For this effective resource management is to be done.</p><p class="text-idt25" data-id="13">To address this issue the designs are broken into parts and then mapped into the device.Each part needs it share of resources whenever the are required.For this the less important chunks of designs are suspended and the resources are allocated to the urgent or important parts of designs.</p><p class="text-idt25" data-id="14">Even while multitasking i.e.multiple users using the device at the same time, some designs are more important or urgent than others.For example suppose I am running a design on the emulator and some senior engineer need to use the deviceso in that situation my design is not killed as the time spent so far would be wasted.So the design is suspended, the important designs given the hardware resources they require and when the important design is over, the less important design is resumed.</p><p class="text-idt25" data-id="15">72.2 Suspend-Resume script There was an already existing suspend-resume bash script with some limited features and some bugs.I added new features and fixed all the bugs making the script usable.It was even made accessible to their clients as well as team members.We also received some bug reports by ARM which were also discussed and was fixed.</p><p class="text-idt25" data-id="16">2.3 Working of the script Using ’ps’ command in linux we can find process ids or PIDs of all the running processes.To further get sub processes of a process we need to find the PIDs in the process tree of a process id.For this we use ’pstree’ command.In the bash script we give the PID of the design we need to suspend or resume and thescript finds all the sub process ids of that PID and suspends or resume all of them.This ensures that the complete process or designs are taken into consideration.</p><p class="text-idt25" data-id="17">First the designs are run in background (in background shell and not on the main or current shell) and the suspend resume script is called on themain shell and is provided with the process id or PID of the design and it monitors the design and sends it required signals at appropriate times.If designs run on the main shell then we will not be able to monitor it.</p><p class="text-idt25" data-id="18">Then at appropriate time the suspend script sends suspend or SIG-STOP signal to the design.Now our script waits for the design to suspend.It does by checking the linux shell process tree or pstree as they have information on the running status of the processes.</p><p class="text-idt25" data-id="19">After sending signal it keeps waiting until design is not completely suspended.</p><p class="text-idt25" data-id="20">Then after meeting the objectives, some hard-coded time in case but in real world some important high preference design, a resume signal is sent to the process.Again it waits for the design to completely resume.This cycle repeats as per the user requirements or test case specifies.Special instructions could be given in a special file made for this purpose named ’run.do’.</p><p class="text-idt25" data-id="21">82.4 Types of suspend-resume Based on the moments we send suspend-resume signals, there are three types of suspend-resumes •Random :In this suspend signal is send after a fixed time and then the scripts waits and again sends the resume signal.Since at each suspend and resume phases the time taken to suspend or resume completely is variable we call this type as random(pseudo-periodic to be more precise).In ideal cases the all suspend-resume cycles would take the same time but in real case different processes are too complicated to be suspend quickly.An example could be data download phase.Suspending designs when they are downloading data is not wise decision as it may lead to data corruption.</p><p class="text-idt25" data-id="22">•Regex based :In some cases some word or regular expression (regex) is written in a file and at that moment we want to send the suspend or resume signal.The bash script is provided with a regex and a log-file where that word is searched.As soon as the word is written the suspend-resume cycle starts and after one cycle it does not repeat the process but it waits on the PID to complete.</p><p class="text-idt25" data-id="23">•File based :In some designs some temporary files are created.On finding a file of a given name in a given directory the suspend-resume signal sends signals to the process or design.We could also create a file by injecting the ’touch filename’ linux command somewhere (at appropriate or required place) in our design.On creation of that file we ensure that suspend or resume signals are sent at appropriate points in the design run.</p><p class="text-idt25" data-id="24">2.5 Arguments that could be provided to the script The following arguments could be provided to the script while calling or invoking it •–pid(reqd.) :A required argument to provide the script with the process id or PID of our design.</p><p class="text-idt25" data-id="25">9•–regword :To provide the regword which is searched in a logfile and on finding which suspend-resume signals are sent.</p><p class="text-idt25" data-id="26">•–logfile :To provide the file name in which the regex or regular expression is searched for the script to send appropriate signals.</p><p class="text-idt25" data-id="27">•–filename :To provide the name of the file on creation of which the suspend resume seignals are sent.</p><p class="text-idt25" data-id="28">•–cycle-count :To give the number of times the suspend-resume cycles are repeated.</p><p class="text-idt25" data-id="29">2.6 Conclusion Out of the 52 test-cases provided around 45 were successfully passed.There were bugs found in others which were filed on JIRA for the appropriate team to work upon it.Another problem that left unsolved was that in some cases suspend-signal were sent at inappropriate points that might lead to failed test-cases or data loss.These problems might be solved using a database of points where suspend signals should not be sent andbefore sending suspend signals the design points or stage need to be check in that database.</p><p class="text-idt25" data-id="30">10Chapter 3 Netropy Delay Campaign Mentor Graphics provides access to the Veloce device to its customers using servers.There are tens of servers interacting with each other.These servers machines are in different countries most of them in Meudon, France and Fremont, USA.Delay between servers are inevitable.So we need to modify the device accordingly to handle such delays and provide required results in any adverse situation.</p><p class="text-idt25" data-id="31">3.1 Introduction Our aim is to model such delays as we might face in real world and modify our device accordingly.For this we use a device called netropy which is made by a third party hardware manufacturer ’apposite tech’.</p><p class="text-idt25" data-id="32">3.2 Netropy delay script We control the device using python script.The script was already there with the basic functionality of controlling the device using APIs provided by the device manufacturer.I introduced the functionalities and logic and made the script functional.</p><p class="text-idt25" data-id="33">3.3 Working of the script The script is called giving the PID of the process.The netropy device is connected to the machines at Fremont, USA, so presently delays could be introduced only between 11Figure 3.1:Netropy Device Fremont server machines.The netropy device could be controlled using APIs or using url on a web browser.</p><p class="text-idt25" data-id="34">First we define end-points and paths.End-points are the two server machines between which delays are to be introduced.The connection between the two machines is called a path.Mainly we work only on four machines.So in total we have nCr = 4C2 = 12 possible paths.Now the task left is to introduce delay in those paths.The path creation task is done one time only though web browser and switching on the device, introducing appropriate delays at various time frames is done using a python script.</p><p class="text-idt25" data-id="35">We use ’pexpect’ package of python that helps in connecting with the device.It sends request to the hardware and expects a response.On receiving an appropriate response it knows that the connection is working successfully.</p><p class="text-idt25" data-id="36">123.4 Types of delay modelling Based on time instants when delays are introduced, delay modelling is divided into three parts •Random :In this type of delay modelling delays are introduced between the given servers after a fixed time when the script is called.Then the delays are removed and again introduced after a fixed time.This fixed time could also be changed by proving it at the time of script call.This cycle continues till the PID of the design or process keeps running.For this python ’os’ libraries are used.</p><p class="text-idt25" data-id="37">•Regex based :In some cases delays are to be introduced between the specifies servers after some words or regex (regular expression) is written in a log-file.This delay is there until the PID exists.If we want to remove delays before that we need to provide the ’duration’ argument while calling the script.</p><p class="text-idt25" data-id="38">•File based :For some designs delays are introduced when a specified file is found in some directory.Temporary files are created when designs run.After finding one such file, name provided to the script using ’filename’ argument, delays are introduced between the servers.</p><p class="text-idt25" data-id="39">The APIs accept different types of delays.Based on time-delay relation we have 4 types of delays •Constant :A constant or fixed value delay is introduced between the two given servers throughout the runtime of the process or design.</p><p class="text-idt25" data-id="40">•Linear :Delay value is linearly increased with runtime.      •Exponential :Delay value is exponentially increased with runtime.</p><p class="text-idt25" data-id="41">•Gaussian :Graph between delay value and runtime is normal or gaussian shaped.</p><p class="text-idt25" data-id="42">3.5 Arguments that could be provided to the script The following arguments could be provided to the script while calling or invoking it •–pid(reqd) :A required parameter to pass the PID of the process or design.</p><p class="text-idt25" data-id="43">13•–src(reqd) :A required parameter to pass the source server or machine name.</p><p class="text-idt25" data-id="44">•–dest(reqd) :A required parameter to pass the destination or machine name.</p><p class="text-idt25" data-id="45">•–delay :To provide the delay value between two servers•–duration :To provide the duration for which delays are introduced.</p><p class="text-idt25" data-id="46">•–regword :To provide the word or regex (regular expression) in finding of which in a given logfile delays are introduced between servers.</p><p class="text-idt25" data-id="47">•–logfile :To provide the file name in which the regex is searched for.</p><p class="text-idt25" data-id="48">•–filename :To provide the name of the file on creation of which in a specified directly delays are introduced between the given servers.</p><p class="text-idt25" data-id="49">•–bi :Boolean argument or flag passed when delays are to be introduced in both sides i.e.source to destination as well as destination to source.</p><p class="text-idt25" data-id="50">3.6 Conclusion Out of the 50 available test cases around 35 passed.Mentor Graphics is coming up with a new version of the veloce device - Veloce X.There were some bugs found when these test cases were run on the new device.This campaign is further under development.</p><p class="text-idt25" data-id="51">14Chapter 4 C-API testing The older versions of Veloce only supported computing resources allocation though APIs, but for the new upcoming device,Veloce X, storage memory (SBMEM) and AVB reservation is also supported as it was demanded by the company’s customers.</p><p class="text-idt25" data-id="52">4.1 Introduction The RnD team made the C APIs for the same and that had to be tested.My mentor was the owner of this campaign.My role was to write some C scripts to invoke that API in order to assist my mentor.</p><p class="text-idt25" data-id="53">A C script was made to call the API passing structures passed by reference that were populated by the API for the results.</p><p class="text-idt25" data-id="54">4.2 Working of the script The C script accepts allowed resources as arguments and makes an empty structure.</p><p class="text-idt25" data-id="55">Then it calls the API which populates this structure (structures are passed by reference).</p><p class="text-idt25" data-id="56">After getting the results from API we match whether the allocated resources are indeed from the list of allowed resources provided or not.</p><p class="text-idt25" data-id="57">Since C does not have string data structure or data type, strings are represented as character arrays.To provide arguments in a beautiful way (like ./script –list i1, i2, i3)while invoking the script weuse a wrapper bash script that handles all the string arguments 15and change those to numbers and calls C script using them.This gives a better UI to the user.</p><p class="text-idt25" data-id="58">4.3 Arguments that could be provided to the script The following arguments could be provided to the script while calling or invoking it •–pid(reqd) :To provide the process id or PID of the process.</p><p class="text-idt25" data-id="59">•–pathname(reqd) :To provide the path of the test case•–avb list(reqd) :To provide list of allowed AVBs.</p><p class="text-idt25" data-id="60">•–sbmem list :To provide list of allowed SBMEMs or memories.      •–io list :To provide list of allowed IO ports.</p><p class="text-idt25" data-id="61">•–comod list :To provide list of allowed COMODAL hosts (machines) or servers 4.4 Conclusion The script was checked for multiple scenarios and was found to be working fine.It was then pushed into the main RnD repository for the team to use.A campaign having around 20 test-cases was also launched and each of them got passed.</p><p class="text-idt25" data-id="62">16Chapter 5 JSON-Screen match Resource and memory usage of device could be found out using two different ways.</p><p class="text-idt25" data-id="63">One if by using the linux command line way.Another way is using servers requests.</p><p class="text-idt25" data-id="64">5.1 Introduction Resource management information includes memory utilised by different user, approximate time left, which personcurrently has taken lock over an emulator and is owner for that at that moement and so on.These information is critical as resource reservation could be done only after we have sufficient information on the current state of the device.</p><p class="text-idt25" data-id="65">Resource information taken using linux command line is in text form, we call that text file ’screen’.It has many key and respective values on separate line.for example we have 4 AVBs in a single Veloce board, and AVB property corresponding to a user would give how much AVBs the user is currently making into use.</p><p class="text-idt25" data-id="66">The server request method return this information in JSON format, named ’json out’.</p><p class="text-idt25" data-id="67">Some properties in that format is in nested form, sub properties inside properties, so we need to parse the information accordingly.</p><p class="text-idt25" data-id="68">I made a python script completely from scratch.It was to extract information from both the ’screen’ and ’json out’ and match them in order to make sure that they are consistent.</p><p class="text-idt25" data-id="69">175.2 Working of the script The python script makes two dictionaries to store key value pairs extracted from the two source files.Now values in those two dictionaries are matched with each other.</p><p class="text-idt25" data-id="70">The main challenge was to deal with the nested JSON formats.I was storing information from the two sources in a python dictionary but the nested parts of the JSON had multiple keys and values.Python doesn’t support hashing for lists so I came out with a way to jointhe keys using spaces and in between each key an identifier for the keys.So this reduced the multiple keys problem to a string which is hashable.Another dictionary was used to get back the list of attributes from the string as key afterall comparison work is done and the values that differ are to be shown.</p><p class="text-idt25" data-id="71">5.3 Arguments that could be provided to the script The following arguments could be provided to the script while calling or invoking it •–pid :To provide the process id or PID of the process.</p><p class="text-idt25" data-id="72">•–pathname(reqd) :To provide the path of the test case•–filename :To provide a file in which the PID of the process to be searched for in case the PID is not provided.</p><p class="text-idt25" data-id="73">5.4 Conclusion The script was checked for multiple scenarios and was found to be working fine.It was then pushed into the main RnD repository for the team to use.A campaign having around 25 test-cases was also launched and each of them got passed.</p><p class="text-idt25" data-id="74">18References•Siemens EDA Website :https://www.google.com/url?sa=trct=jq=esrc=ssource=webcd=cad=rjauact=8ved=2ahUKEwjg8reXw-r0AhX-wTgGHXK5CdEQtwJ6BAgJ EAMurl=https•Wikipedia :https://www.google.com/url?sa=trct=jq=esrc=ssource= webcd=ved=2ah UKEwjg8reXw-r0AhX-wTgGHXK5CdEQFnoECAMQAQurl=https 19</p>        </div>
        <div class="paper-footer">
            <div data-lang="PaperFooter">This report is powerd by paperpass.net similarity detecting system</div>
            <div><span data-lang="Copyright">Copyright</span> © 2021 <a href="https://www.paperpass.net/" target="_blank">PaperPass.Net</a></div>
        </div>
    </div>
    <span style="display: none;">This__is__the__place__to__load__the__download__file__code.__The__offline__version__is__hidden,__but__the__online__version__will__have__it.</span>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/Lib.js"></script>
<script src="js/detaildata.js"></script>
<script src="js/language.js"></script>
<script>
    Report.report_id = '61bda8c6e5ed2gmwu';
</script>
<script type="text/javascript">
    (function (System,$) {
        System.operateState.saveId(Report.report_id);
        var cache = new System.Cache(System.report_id,localStorage);
        $(function(){
            $.each(cache.get(),function(){
                $('[data-id='+this.id+']').addClass('g-font-color green').html(this.text);
            });
            var leng = System.operateState.getLanguage(Report.report_id);
            if (leng != '') {
                leng = typeof multilingual[leng] == "undefined" ? "English" : leng;
            } else {
                leng = typeof multilingual[user_language] == "undefined" ? "English" : user_language;;
            }
            parent.postMessage("get_language", "*");
            SwitchMultilingual(leng);
            function SwitchMultilingual(leng) {
                $('*[data-lang]').each(function () {
                    var name = $(this).data().lang;
                    $(this).html(multilingual[leng][name]);
                });
            }
            window.addEventListener("message", function(event) {
                if (event.data.leng) {
                    leng = event.data.leng;
                    SwitchMultilingual(leng);
                    System.operateState.saveLanguage(Report.report_id, leng);
                }
            });
        });
    })(Report,jQuery);
</script>
</html>