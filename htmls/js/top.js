(function(o,r){var e=o.operateState.getHeaderState(Report.report_id);t(e);r(".HeaderButton").click(function(){var e=r(".paper-header").css("display");o.operateState.saveHeaderState(Report.report_id,e);t(e);I()});function t(e){if(e=="block"||e==""){r(".paper-header").hide();r("#m-content").css("top","40px");r(".overall-similarity").show();r(".header_logo").show();r(".clickimg").css("background-position","-10px -98px");r(".dropdown-menu ul").css("top","40px")}else{r(".paper-header").show();r("#m-content").css("top","140px");r(".overall-similarity").hide();r(".header_logo").hide();r(".clickimg").css("background-position","-71px -98px");r(".dropdown-menu ul").css("top","140px")}}var d=o.operateState.getLanguage(Report.report_id);if(d!=""){d=typeof multilingual[d]=="undefined"?"English":d}else{d=typeof multilingual[user_language]=="undefined"?"English":user_language}c(d);function c(t){r("*[data-lang]").each(function(){var e=r(this).data().lang;r(this).html(multilingual[t][e])})}var i=o.operateState.getALink(Report.report_id);var a=o.operateState.getTabName(Report.report_id);l(a);v();r("#childIframe").attr("src",i);s();r("#m-nav .active_li").each(function(){var e=r(this).find(".detailed_description").data().lang;if(a==e){r(this).addClass("active");r(this).siblings().removeClass("active")}if(a=="UseHelp"){r("#nav_ul .active_li.active").removeClass("active")}});r("#m-nav .active_li").click(function(){var e=r(this).find(".detailed_description").data().lang;var t=r(this).find("a").attr("href");o.operateState.saveALink(Report.report_id,t);o.operateState.saveTabName(Report.report_id,e);l(e);if(e=="UseHelp"){r("#nav_ul .active_li.active").removeClass("active")}});function l(e){var t="";if(e==""||e=="DetailReport"){t+='<div class="layui_fixed_layer"></div>'+'<div class="layui_loading_shade">'+'<div class="layui-layer main_layer">'+'<div class="layui-layer-content">'+multilingual[d].LoadingReport+"</div>"+"</div>"+"</div>";r("#m-content").append(t);var i=o.operateState.getFoldState(Report.report_id);var a=o.operateState.getInitDetailReport(Report.report_id);p(i);n(a)}if(e=="ViewOriginal"){t+='<div class="layui_fixed_layer"></div>'+'<div class="layui_loading_shade">'+'<div class="layui-layer main_layer">'+'<div class="layui-layer-content">'+multilingual[d].LoadingOriginal+"</div>"+"</div>"+"</div>";r("#m-content").append(t);var a=o.operateState.getInitViewOriginal(Report.report_id);n(a)}}function s(){var e=o.operateState.getInitViewOriginal(Report.report_id);if(is_has_word){if(e==""||e=="word"){r(".original-nav a").attr("href","htmls/word/word_original.html")}else{r(".original-nav a").attr("href","htmls/text/text_original.html")}}else{r(".original-nav a").attr("href","htmls/text/text_original.html")}}function n(e){if(is_has_word){if(e==""||e=="word"){r(".layui_loading_shade").css("background","#484f52")}else{r(".layui_loading_shade").css("background","#e7e7e7")}}else{r(".layui_loading_shade").css("background","#e7e7e7")}}function p(e){if(e=="none"){r(".layui_loading_shade").css("width","100%")}else{r(".layui_loading_shade").css("width","70%")}}function v(){var e=document.documentElement.clientWidth;r("#nav_ul li").each(function(){if(e>1280){r(".tab li a").css("padding","0 20px");r(".nav-tit h4").css("font-size","20px")}else{r(".tab li a").css("padding","0 10px");r(".nav-tit h4").css("font-size","16px")}})}r(".dropdown-toggle").click(function(){if(r(".download-format").css("display")=="block"){r(".customize-select .dropdown-menu ul").css("right","123px")}else{r(".customize-select .dropdown-menu ul").css("right","81px")}r(".customize-select .dropdown-menu").toggle();r(".customize-select .caret").css({transform:"rotate(180deg)"})});r(".dropdown-menu *[data-option]").each(function(){if(d==r(this).data().option){r(".customize-select-text").html(r(this).html());r(".dropdown-menu").find("li.selected").removeClass("selected");r(this).parent("li").addClass("selected")}});r(document).on("click",".customize-select .dropdown-menu li > a",function(e){e.preventDefault();location.reload();var t=r(this).text();var i=r(this).parent("li");if(!i.hasClass("ignore")){var a=r(".customize-select");var l=a.attr("data-name");var s=a.find('input[name="'+l+'"]');r(".dropdown-menu").find("li.selected").removeClass("selected");i.addClass("selected");a.find(".customize-select-text").html(t);s.val(t)}var n=r(this).attr("data-option");d=typeof multilingual[n]=="undefined"?"English":n;c(d);o.operateState.saveLanguage(Report.report_id,d);N.contentWindow.postMessage({leng:d},"*")});r(".download-format").click(function(){r(this).find(".dropdown-menu").toggle()});r(".customize-select .dropdown-menu").click(function(){r(this).hide();r(".customize-select .caret").css({transform:"rotate(0deg)"})});r(".help_img,.download_img").mousemove(function(){r(this).parents(".ML20").find(".detailed_description").css("display","block")}).mouseout(function(){r(this).parents(".ML20").find(".detailed_description").css("display","none")});window.addEventListener("message",function(e){if(e.data=="switch-detail-text"){o.operateState.saveInitDetailReport(Report.report_id,"text");l("DetailReport");r(".popover").hide()}if(e.data=="switch-detail-word"){o.operateState.saveInitDetailReport(Report.report_id,"word");l("DetailReport");r(".popover").hide()}if(e.data=="switch-original-text"){o.operateState.saveALink(Report.report_id,"htmls/text/text_original.html");o.operateState.saveInitViewOriginal(Report.report_id,"text");l("ViewOriginal");r(".original-nav a").attr("href","htmls/text/text_original.html");r(".popover").hide()}if(e.data=="switch-original-word"){o.operateState.saveALink(Report.report_id,"htmls/word/word_original.html");o.operateState.saveInitViewOriginal(Report.report_id,"word");l("ViewOriginal");r(".original-nav a").attr("href","htmls/word/word_original.html");r(".popover").hide()}if(e.data=="Page_Loading"){r(".layui_loading_shade").remove();r(".layui_fixed_layer").remove()}if(e.data.FoldState){O(e.data.FoldState)}if(e.data=="get_language"){N.contentWindow.postMessage({leng:d},"*")}});function h(e){var t="";t+='<div class="popover bookmark" id="'+e+'">'+'<div class="popover-child">'+'<div class="popover-title flex-between">'+'<div class="flex">'+'<div class="font-bold">'+multilingual[d].DirectoryNavigation+"</div>"+'<div class="mclick_show"><span>[</span><span class="mclick_span">'+multilingual[d].ExpandAll+'</span><i class="g-arrow-i"></i><span>]</span></div>'+"</div>"+'<button type="button" class="close"><span aria-hidden="true"></span></button>'+"</div>"+'<div class="popover-content">'+'<div class="overflow_ul"></div>'+"</div>"+"</div>"+"</div>";r("#m-content").append(t)}function u(e){var i="";if(e.length==0){i+='<div style="text-align: center;margin-left: -40px;padding: 15px 0;">'+multilingual[d].EmptyDirectoryNavigation+"</div>"}else{e.forEach(e=>{var t=e.children!="undefined"&&e.children&&e.children.length?u(e.children):null;if(t!=null){i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_img mselect_img_detail"></div>'+'<div class="mselect_tit">'+'<a href="htmls/word/word_report.html'+e.anchorPoint+'" target="left" class="third-class">'+e.content+"</a>"+"</div>"+"</div>"+t+"</div>"}else{i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_tit ML20">'+'<a href="htmls/word/word_report.html'+e.anchorPoint+'" target="left" class="third-class">'+e.content+"</a>"+"</div>"+"</div>"+"</div>"}})}return i}function g(e){var i="";if(e.length==0){i+='<div style="text-align: center;margin-left: -40px;padding: 15px 0;">'+multilingual[d].EmptyDirectoryNavigation+"</div>"}else{e.forEach(e=>{var t=e.children!="undefined"&&e.children&&e.children.length?g(e.children):null;if(t!=null){i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_img mselect_img_original"></div>'+'<div class="mselect_tit">'+'<a href="htmls/word/word_original.html'+e.anchorPoint+'" target="main" class="third-class">'+e.content+"</a>"+"</div>"+"</div>"+t+"</div>"}else{i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_tit ML20">'+'<a href="htmls/word/word_original.html'+e.anchorPoint+'" target="main" class="third-class">'+e.content+"</a>"+"</div>"+"</div>"+"</div>"}})}return i}function f(e){return JSON.stringify(JSON.parse(e)).replace(/</g,"&lt;").replace(/>/g,"&gt;")}h("detail_report");h("original_report");var m=JSON.parse(f(detail_json));u=u(m);r("#detail_report .overflow_ul").html(u);var _=JSON.parse(f(original_json));g=g(_);r("#original_report .overflow_ul").html(g);r(".overflow_ul").children(".layui-nav-third-child").removeClass("layui-nav-third-child");r(".third-class").each(function(){var e=40;var t=r(this).text().trim();var i=t.length;if(i>e){r(this).html(t.substring(0,e)+"...")}});r(".mselect_img").click(function(){var e=r(this).parent().siblings(".layui-nav-third-child");if(r(this).hasClass("opened")){e.hide();e.find(".mselect_img").removeClass("opened");e.find(".mselect_img").css("background-position","-115px -245px");r(this).css("background-position","-115px -245px");r(this).removeClass("opened")}else{e.show();r(this).css("background-position","-77px -245px");r(this).addClass("opened")}});function w(e){var i=true;r.each(e,function(e,t){if(!r(t).hasClass("opened")){i=false}});if(i){r(".mclick_span").text(multilingual[d].CollapseAll);r("i.g-arrow-i").css({"border-color":"transparent transparent #56b282",top:"13px"})}else{r(".mclick_span").text(multilingual[d].ExpandAll);r("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"})}}r(".mselect_img_detail").click(function(){var e=r(".mselect_img_detail");w(e)});r(".mselect_img_original").click(function(){var e=r(".mselect_img_original");w(e)});if(r(".layui-nav-third-child").length==0){r(".mclick_show").hide()}r(".mclick_show").click(function(){var e=r(this).parent().parent().next().find(".layui-nav-third-child");var t=r(this).parent().parent().next().find(".mselect_img");if(e.is(":hidden")){if(r(this).find(".mclick_span").text()==multilingual[d].CollapseAll){e.hide();t.css("background-position","-115px -245px");r(this).find(".mclick_span").text(multilingual[d].ExpandAll);r("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"});r(".mselect_img").removeClass("opened")}else{e.show();t.css("background-position","-77px -245px");r(this).find(".mclick_span").text(multilingual[d].CollapseAll);r("i.g-arrow-i").css({"border-color":"transparent transparent #56b282",top:"13px"});r(".mselect_img").addClass("opened")}}else{e.hide();t.css("background-position","-115px -245px");r(this).find(".mclick_span").text(multilingual[d].ExpandAll);r("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"});r(".mselect_img").removeClass("opened")}});var y="";y+='<div class="popover bookmark layui-page-nav-child">'+'<div class="popover-child">'+'<div class="popover-title flex-between">'+'<div class="flex">'+'<div class="font-bold">'+multilingual[d].WebpageNavigation+"</div>"+'<ul class="nav-btns clearfix">'+"<li><span></span></li>"+'<li class="active"><span></span></li>'+"<li><span></span></li>"+"</ul>"+"</div>"+'<button type="button" class="close"><span aria-hidden="true"></span></button>'+"</div>"+'<div class="book-mark-body overflow_ul book-mark-center">'+'<div class="pic-list clearfix" style="width: 288px"></div>'+"</div>"+"</div>"+"</div>";r("#m-content").append(y);function x(e){var i="";if(e.length==0){r(".nav-btns").hide();i+='<div style="float:none;color:#000000">'+multilingual[d].EmptyWebPageNavigation+"</div>"}else{r(".nav-btns").show();e.forEach((e,t)=>{i+=`<div><a href="javascript:;"><img src="${e}"></a><div class="page-nav-id">${t+1}</div></div>`})}return i}function b(t){r(".pic-list a").each(function(e){var e=e+1;if(e==t){r(this).addClass("active");r(this).parent()[0].scrollIntoView(false)}else{r(this).removeClass("active")}})}function k(i,a){r(".pic-list a").each(function(e){if(i==e+1){r(this).addClass("active");if(a=="false"){r(this).parent()[0].scrollIntoView(false)}var t=document.getElementById("childIframe");t.contentWindow.postMessage({page_nav_click:"false"},"*")}else{r(this).removeClass("active")}})}r(document).on("click",".nav-btns li",function(){E.call(this);r(this).parents(".layui-page-nav-child").find("li").each(function(e,t){var e=e+1;if(e==1&&r(this).hasClass("active")){r(this).parents(".layui-page-nav-child").find(".pic-list").css("width","144px");S(e)}else if(e==2&&r(this).hasClass("active")){r(this).parents(".layui-page-nav-child").find(".pic-list").css("width","288px");S(e)}else if(e==3&&r(this).hasClass("active")){r(this).parents(".layui-page-nav-child").find(".pic-list").css("width","432px");S(e)}})});function S(e){var t=o.operateState.getTabName(Report.report_id);var i=o.operateState.getInitDetailReport(Report.report_id);var a=o.operateState.getInitViewOriginal(Report.report_id);if(t==""||t=="DetailReport"){if(i=="word"||i==""){o.operateState.savePageNavState(Report.report_id,e)}else{o.operateState.savePTPageNavState(Report.report_id,e)}}else{if(a=="word"||a==""){o.operateState.saveOriPageNavState(Report.report_id,e)}else{o.operateState.saveOPTPageNavState(Report.report_id,e)}}}function R(){var e=o.operateState.getTabName(Report.report_id);var t=o.operateState.getInitDetailReport(Report.report_id);var i=o.operateState.getInitViewOriginal(Report.report_id);if(e==""||e=="DetailReport"){if(t=="word"||t==""){return o.operateState.getPageNavState(Report.report_id)}else{return o.operateState.getPTPageNavState(Report.report_id)}}else{if(i=="word"||i==""){return o.operateState.getOriPageNavState(Report.report_id)}else{return o.operateState.getOPTPageNavState(Report.report_id)}}}r(document).delegate(".pic-list a","click",function(){r(this).parents(".pic-list").find("a").removeClass("active");r(this).addClass("active");var e=r(this).next(".page-nav-id").text();var t={EnterId:e,page_nav_click:"true"};N.contentWindow.postMessage(t,"*")});function C(e){r(".layui-page-nav-child").find(".nav-btns li").each(function(){if(r(this).hasClass("active")){r(this).removeClass("active")}});if(e=="1"){r(".layui-page-nav-child").find(".nav-btns li:first-child").addClass("active");r(".layui-page-nav-child").find(".pic-list").css("width","144px")}else if(e=="2"||e==""){r(".layui-page-nav-child").find(".nav-btns li:nth-child(2)").addClass("active");r(".layui-page-nav-child").find(".pic-list").css("width","288px")}else if(e=="3"){r(".layui-page-nav-child").find(".nav-btns li:last-child").addClass("active");r(".layui-page-nav-child").find(".pic-list").css("width","432px")}}r("#m-nav a").click(function(){r(".popover").hide();r(".layui-page-nav-child").hide()});var N=document.getElementById("childIframe");var E=o.Paper.tab();var P=o.Paper.textSectionSave(null);r(function(){if("undefined"===typeof localStorage||"undefined"===typeof JSON){r("body").append('<div class="alert-warning"><p>'+multilingual[d].SupportBrowser+"</p></div>")}r(document).on("click",'[tab-a="ul"] .active_li',function(){E.call(this)});var e=r("#detail_report").css("display");var t=r("#original_report").css("display");var i=r(".layui-page-nav-child").css("display");var a={child1:e,child2:t,child3:i,leng:d};r(".close").click(function(){r(".popover").hide();r(".layui-page-nav-child").hide();N.contentWindow.postMessage(a,"*")});N.contentWindow.postMessage(a,"*");r(document).on("click","[tpl-section-save=btn]",function(){P.call(this)});r(document).on("click","[tpl-section-cancle=btn],[tpl-section-save=btn],.layui-layer-setwin",function(){r("#section-edit-modal").css("display","none");r("#modify-document-modal").css("display","none");r(".layui-layer").css("display","none")});window.addEventListener("message",function(e){r("#detail_report").css("display",e.data.state1);r("#original_report").css("display",e.data.state2);r(".layui-page-nav-child").css("display",e.data.navState);if(e.data.state1=="block"||e.data.state2=="block"){I()}if(e.data.navState=="block"){var t=x(e.data.page_nav);r(".pic-list").html(t);C(R());b(e.data.pageNum);I()}if(e.data.PageNum){k(e.data.PageNum,e.data.page_nav_click)}if(e.data.section_edit){r("#section-edit-modal").css("display","block");r("#layui-layer-section").css("display","block");var i=JSON.parse(f(section_edit_json));var a=e.data.section_edit.trim();r(".section-txt.section-txt-prev").text("");r.each(i[a],function(e,t){if(t.score>=.4&&t.score<.7){var i=r('<span class="orange">'+t.content+"</span>")}else if(t.score>=.7){var i=r('<span class="red">'+t.content+"</span>")}else{var i=r("<span>"+t.content+"</span>")}r(".section-txt.section-txt-prev").append(i)});r(".section-id").text(a);var l=o.Paper.textSectionEdit();l.call(this)}if(e.data.modify_document){r("#modify-document-modal").css("display","block");r("#layui-layer-document").css("display","block");r("#modifyDocument").attr("src","htmls/modify_document.html")}})});function O(e){var t=document.documentElement.clientWidth;if(e=="none"){r(".bookmark").css({width:t*.29,left:"auto",right:"72px"})}else{r(".bookmark").css({width:t*.29,left:t*.7-30,right:"auto"})}}I();function I(){var e=document.documentElement.clientWidth;var t=document.documentElement.clientHeight;var i=o.operateState.getTabName(Report.report_id);var a=o.operateState.getFoldState(Report.report_id);var l=r(".paper-header").css("display");if(l=="block"){r(".overflow_ul").css("height",t-220)}if(l=="none"){r(".overflow_ul").css("height",t-120)}if(a=="none"||i=="ViewOriginal"){r(".bookmark").css({width:e*.29,left:"auto",right:"72px"})}else{r(".bookmark").css({width:e*.29,left:e*.7-30,right:"auto"})}}r(window).resize(function(){v();I()})})(Report,jQuery);